<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Done! ⚡ - Superhuman productivity at your fingertips</title>
    <meta name="description" content="A lightning-fast, intuitive to-do list app that makes you feel unstoppable">
    <meta name="theme-color" content="#22c55e">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Framer Motion CDN -->
    <script src="https://unpkg.com/framer-motion@10.16.0/dist/framer-motion.js"></script>
    
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- date-fns CDN -->
    <script src="https://unpkg.com/date-fns@2.30.0/index.js"></script>
    
    <style>
        /* Custom styles and animations */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .task-item {
            @apply relative select-none transition-all duration-200 rounded-xl bg-white shadow-sm hover:shadow-md;
        }
        
        .task-item-completed {
            @apply opacity-60 line-through;
        }
        
        .task-item-dragging {
            @apply z-20 shadow-lg scale-105 rotate-2;
        }
        
        .tab-button {
            @apply flex flex-col items-center px-2 pt-1 pb-0.5 border-b-2 transition-all duration-200;
        }
        
        .tab-button-active {
            @apply text-blue-600 border-blue-500;
        }
        
        .tab-button-inactive {
            @apply text-gray-400 border-transparent hover:text-gray-600;
        }
        
        .floating-button {
            @apply fixed bottom-20 right-6 z-30 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg w-16 h-16 flex items-center justify-center text-3xl font-bold transition-all duration-200 hover:scale-110 active:scale-95;
        }
        
        .input-field {
            @apply flex-1 px-4 py-3 rounded-xl border border-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-200 text-lg bg-blue-50 placeholder-gray-400;
        }
        
        .primary-button {
            @apply bg-blue-500 hover:bg-blue-600 text-white px-5 py-2 rounded-xl font-semibold text-lg transition-colors;
        }
        
        /* Custom animations */
        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(100%); opacity: 0; }
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
        .animate-slide-out { animation: slideOut 0.3s ease-in; }
        .animate-bounce-in { animation: bounceIn 0.5s ease-out; }
        .animate-fade-in { animation: fadeIn 0.2s ease-out; }
        .animate-scale-in { animation: scaleIn 0.2s ease-out; }
        
        /* Custom colors */
        .bg-soulful-50 { background-color: #f0fdf4; }
        .bg-soulful-100 { background-color: #dcfce7; }
        .bg-soulful-200 { background-color: #bbf7d0; }
        .bg-soulful-300 { background-color: #86efac; }
        .bg-soulful-400 { background-color: #4ade80; }
        .bg-soulful-500 { background-color: #22c55e; }
        .bg-soulful-600 { background-color: #16a34a; }
        .bg-soulful-700 { background-color: #15803d; }
        
        .text-soulful-400 { color: #4ade80; }
        .text-soulful-500 { color: #22c55e; }
        .text-soulful-600 { color: #16a34a; }
        .text-soulful-700 { color: #15803d; }
        
        .border-soulful-200 { border-color: #bbf7d0; }
        .border-soulful-500 { border-color: #22c55e; }
        
        .focus\:ring-soulful-200:focus { --tw-ring-color: #bbf7d0; }
        
        /* Hide scrollbars */
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="antialiased">
            <div id="app" class="min-h-screen flex flex-col bg-gradient-to-b from-blue-50 via-white to-blue-50 pb-24 md:pb-0">
        <!-- Header -->
        <header class="pt-8 pb-4 px-6 flex flex-col gap-1">
            <div class="flex items-center justify-between">
                <div>
                            <h1 class="text-3xl font-bold text-blue-700 tracking-tight">Done! ⚡</h1>
        <p class="text-blue-400 text-base font-medium">Productivity at your fingertips 🚀</p>
                </div>
                <button id="statsBtn" class="p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors" aria-label="View statistics">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main content -->
        <main class="flex-1 w-full max-w-md mx-auto px-2">
            <!-- Tab header -->
            <div class="flex items-center gap-2 mb-4">
                <span id="tabIcon" class="text-2xl">💼</span>
                <h2 id="tabLabel" class="text-xl font-semibold text-blue-700">Work</h2>
                <span id="taskCount" class="ml-auto text-sm text-gray-500">0 tasks</span>
            </div>

            <!-- Search and filters -->
            <div class="mb-4 space-y-2">
                <div class="relative">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <input id="searchInput" type="text" placeholder="Search tasks..." class="w-full pl-10 pr-4 py-2 rounded-xl border border-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-200 bg-white">
                </div>
                
                <div class="flex items-center gap-2">
                    <button id="filterBtn" class="flex items-center gap-1 px-3 py-1.5 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                        </svg>
                        Filters
                    </button>
                    
                    <button id="clearFiltersBtn" class="text-sm text-gray-500 hover:text-gray-700 hidden">Clear</button>
                </div>
                
                <div id="filterPanel" class="space-y-2 hidden">
                    <div class="flex gap-2">
                        <button data-priority="low" class="filter-priority flex-1 py-1.5 px-2 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors text-xs">🟢 Low</button>
                        <button data-priority="medium" class="filter-priority flex-1 py-1.5 px-2 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors text-xs">🟡 Medium</button>
                        <button data-priority="high" class="filter-priority flex-1 py-1.5 px-2 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors text-xs">🔴 High</button>
                    </div>
                    
                    <div class="flex gap-2">
                        <button data-status="all" class="filter-status flex-1 py-1.5 px-2 rounded-lg border border-blue-500 bg-blue-50 text-blue-700 transition-colors text-xs">All</button>
                        <button data-status="pending" class="filter-status flex-1 py-1.5 px-2 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors text-xs">Pending</button>
                        <button data-status="completed" class="filter-status flex-1 py-1.5 px-2 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors text-xs">Completed</button>
                    </div>
                </div>
            </div>

            <!-- Task list -->
            <ul id="taskList" class="flex flex-col gap-2 mt-2">
                <!-- Tasks will be inserted here -->
            </ul>

            <!-- Empty state -->
            <div id="emptyState" class="mt-8 flex flex-col items-center text-blue-300">
                <div class="bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16 mb-3 flex items-center justify-center">
                    <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <span class="text-lg">No tasks yet. Add one!</span>
            </div>
        </main>

        <!-- Tab bar -->
        <nav class="fixed bottom-0 left-0 right-0 z-20 bg-white border-t border-blue-100 flex justify-around py-2 shadow-md md:static md:shadow-none md:border-none md:bg-transparent md:py-0">
            <button data-tab="work" class="tab-button tab-button-active">
                <span class="text-xl mb-0.5">💼</span>
                <span class="text-xs font-medium">Work</span>
            </button>
            <button data-tab="personal" class="tab-button tab-button-inactive">
                <span class="text-xl mb-0.5">🏡</span>
                <span class="text-xs font-medium">Personal</span>
            </button>
            <button data-tab="groceries" class="tab-button tab-button-inactive">
                <span class="text-xl mb-0.5">🛒</span>
                <span class="text-xs font-medium">Groceries</span>
            </button>
            <button data-tab="finance" class="tab-button tab-button-inactive">
                <span class="text-xl mb-0.5">💰</span>
                <span class="text-xs font-medium">Finance</span>
            </button>
            <button data-tab="health" class="tab-button tab-button-inactive">
                <span class="text-xl mb-0.5">🏃</span>
                <span class="text-xs font-medium">Health</span>
            </button>
            <button data-tab="learning" class="tab-button tab-button-inactive">
                <span class="text-xl mb-0.5">📚</span>
                <span class="text-xs font-medium">Learning</span>
            </button>
            <button data-tab="someday" class="tab-button tab-button-inactive">
                <span class="text-xl mb-0.5">🌈</span>
                <span class="text-xs font-medium">Someday</span>
            </button>
        </nav>

        <!-- Floating action button -->
        <button id="addTaskBtn" class="floating-button" aria-label="Add task">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
            </svg>
        </button>
    </div>

    <!-- Add Task Modal -->
    <div id="addTaskModal" class="fixed inset-0 z-30 flex items-end justify-center bg-black bg-opacity-20 hidden">
        <form id="addTaskForm" class="w-full max-w-md mx-auto mb-8 bg-white rounded-2xl shadow-lg p-6">
            <div class="space-y-4">
                <input id="taskText" class="input-field" placeholder="What's on your mind?" required>
                
                <div class="flex gap-2">
                    <button type="button" data-priority="low" class="priority-btn flex-1 py-2 px-3 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors">
                        🟢 Low
                    </button>
                    <button type="button" data-priority="medium" class="priority-btn flex-1 py-2 px-3 rounded-lg border border-blue-500 bg-blue-50 text-blue-700 transition-colors">
                        🟡 Medium
                    </button>
                    <button type="button" data-priority="high" class="priority-btn flex-1 py-2 px-3 rounded-lg border border-gray-200 text-gray-600 hover:border-gray-300 transition-colors">
                        🔴 High
                    </button>
                </div>
                
                <input id="taskDueDate" type="date" class="input-field">
                <textarea id="taskNotes" class="input-field resize-none" placeholder="Notes (optional)" rows="2"></textarea>
                <input id="taskTags" class="input-field" placeholder="Tags (comma separated)">
            </div>
            
            <div class="flex gap-2 mt-6">
                <button type="button" id="cancelAddBtn" class="flex-1 py-3 px-4 rounded-xl border border-gray-200 text-gray-600 hover:bg-gray-50 transition-colors">
                    Cancel
                </button>
                <button type="submit" class="primary-button flex-1">
                    Add Task
                </button>
            </div>
        </form>
    </div>

    <!-- Statistics Modal -->
    <div id="statsModal" class="fixed inset-0 z-30 flex items-center justify-center bg-black bg-opacity-20 hidden">
        <div class="w-full max-w-md mx-4 bg-white rounded-2xl shadow-lg p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-gray-800">Statistics</h3>
                <button id="closeStatsBtn" class="text-gray-400 hover:text-gray-600">✕</button>
            </div>
            
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                                    <div class="text-center p-4 bg-blue-50 rounded-xl">
                    <div id="totalTasks" class="text-2xl font-bold text-blue-600">0</div>
                        <div class="text-sm text-gray-600">Total Tasks</div>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-xl">
                        <div id="completedTasks" class="text-2xl font-bold text-green-600">0</div>
                        <div class="text-sm text-gray-600">Completed</div>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-yellow-50 rounded-xl">
                        <div id="pendingTasks" class="text-2xl font-bold text-yellow-600">0</div>
                        <div class="text-sm text-gray-600">Pending</div>
                    </div>
                    <div class="text-center p-4 bg-red-50 rounded-xl">
                        <div id="overdueTasks" class="text-2xl font-bold text-red-600">0</div>
                        <div class="text-sm text-gray-600">Overdue</div>
                    </div>
                </div>
                
                <div class="bg-gray-50 rounded-xl p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium text-gray-700">Completion Rate</span>
                        <span id="completionRate" class="text-sm font-bold text-blue-600">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="completionBar" class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="highPriorityAlert" class="bg-orange-50 rounded-xl p-4 hidden">
                    <div class="flex items-center gap-2">
                        <svg class="w-5 h-5 text-orange-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                        </svg>
                        <span id="highPriorityText" class="text-sm font-medium text-gray-700">0 high priority tasks pending</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Done! ⚡ App JavaScript
class DoneApp {
            constructor() {
                this.tabs = [
                    { key: "work", label: "Work", icon: "💼" },
                    { key: "personal", label: "Personal", icon: "🏡" },
                    { key: "groceries", label: "Groceries", icon: "🛒" },
                    { key: "finance", label: "Finance", icon: "💰" },
                    { key: "health", label: "Health", icon: "🏃" },
                    { key: "learning", label: "Learning", icon: "📚" },
                    { key: "someday", label: "Someday", icon: "🌈" }
                ];
                
                this.activeTab = 'work';
                this.tasks = this.loadTasks();
                this.searchTerm = '';
                this.filterPriority = null;
                this.filterStatus = 'all';
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.renderTasks();
                this.updateTaskCount();
            }
            
            setupEventListeners() {
                // Tab switching
                document.querySelectorAll('[data-tab]').forEach(btn => {
                    btn.addEventListener('click', () => this.switchTab(btn.dataset.tab));
                });
                
                // Add task button
                document.getElementById('addTaskBtn').addEventListener('click', () => this.showAddModal());
                
                // Add task form
                document.getElementById('addTaskForm').addEventListener('submit', (e) => this.handleAddTask(e));
                document.getElementById('cancelAddBtn').addEventListener('click', () => this.hideAddModal());
                
                // Search
                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.searchTerm = e.target.value;
                    this.renderTasks();
                });
                
                // Filter button
                document.getElementById('filterBtn').addEventListener('click', () => this.toggleFilterPanel());
                
                // Priority filters
                document.querySelectorAll('.filter-priority').forEach(btn => {
                    btn.addEventListener('click', () => this.setPriorityFilter(btn.dataset.priority));
                });
                
                // Status filters
                document.querySelectorAll('.filter-status').forEach(btn => {
                    btn.addEventListener('click', () => this.setStatusFilter(btn.dataset.status));
                });
                
                // Clear filters
                document.getElementById('clearFiltersBtn').addEventListener('click', () => this.clearFilters());
                
                // Priority buttons in add modal
                document.querySelectorAll('.priority-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.setPriorityInModal(btn.dataset.priority));
                });
                
                // Statistics
                document.getElementById('statsBtn').addEventListener('click', () => this.showStats());
                document.getElementById('closeStatsBtn').addEventListener('click', () => this.hideStats());
                
                // Modal backdrop clicks
                document.getElementById('addTaskModal').addEventListener('click', (e) => {
                    if (e.target === e.currentTarget) this.hideAddModal();
                });
                
                document.getElementById('statsModal').addEventListener('click', (e) => {
                    if (e.target === e.currentTarget) this.hideStats();
                });
            }
            
            switchTab(tabKey) {
                this.activeTab = tabKey;
                
                // Update tab buttons
                document.querySelectorAll('[data-tab]').forEach(btn => {
                    btn.classList.remove('tab-button-active');
                    btn.classList.add('tab-button-inactive');
                });
                document.querySelector(`[data-tab="${tabKey}"]`).classList.add('tab-button-active');
                document.querySelector(`[data-tab="${tabKey}"]`).classList.remove('tab-button-inactive');
                
                // Update header
                const tabInfo = this.tabs.find(t => t.key === tabKey);
                document.getElementById('tabIcon').textContent = tabInfo.icon;
                document.getElementById('tabLabel').textContent = tabInfo.label;
                
                this.renderTasks();
                this.updateTaskCount();
            }
            
            showAddModal() {
                document.getElementById('addTaskModal').classList.remove('hidden');
                document.getElementById('taskText').focus();
            }
            
            hideAddModal() {
                document.getElementById('addTaskModal').classList.add('hidden');
                document.getElementById('addTaskForm').reset();
                this.resetPriorityButtons();
            }
            
            handleAddTask(e) {
                e.preventDefault();
                
                const text = document.getElementById('taskText').value.trim();
                if (!text) return;
                
                const priority = document.querySelector('.priority-btn.border-blue-500').dataset.priority;
                const dueDate = document.getElementById('taskDueDate').value;
                const notes = document.getElementById('taskNotes').value.trim();
                const tags = document.getElementById('taskTags').value.split(',').map(t => t.trim()).filter(Boolean);
                
                const task = {
                    id: this.generateId(),
                    text,
                    completed: false,
                    priority,
                    dueDate: dueDate ? new Date(dueDate) : null,
                    createdAt: new Date(),
                    notes: notes || null,
                    tags
                };
                
                if (!this.tasks[this.activeTab]) {
                    this.tasks[this.activeTab] = [];
                }
                
                this.tasks[this.activeTab].unshift(task);
                this.saveTasks();
                this.renderTasks();
                this.updateTaskCount();
                this.hideAddModal();
            }
            
            setPriorityInModal(priority) {
                document.querySelectorAll('.priority-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-700');
                    btn.classList.add('border-gray-200', 'text-gray-600');
                });
                
                const selectedBtn = document.querySelector(`[data-priority="${priority}"]`);
                selectedBtn.classList.add('border-blue-500', 'bg-blue-50', 'text-blue-700');
                selectedBtn.classList.remove('border-gray-200', 'text-gray-600');
            }
            
            resetPriorityButtons() {
                document.querySelectorAll('.priority-btn').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-700');
                    btn.classList.add('border-gray-200', 'text-gray-600');
                });
                
                // Set medium as default
                const mediumBtn = document.querySelector('[data-priority="medium"]');
                mediumBtn.classList.add('border-blue-500', 'bg-blue-50', 'text-blue-700');
                mediumBtn.classList.remove('border-gray-200', 'text-gray-600');
            }
            
            toggleFilterPanel() {
                const panel = document.getElementById('filterPanel');
                panel.classList.toggle('hidden');
            }
            
            setPriorityFilter(priority) {
                this.filterPriority = this.filterPriority === priority ? null : priority;
                this.updateFilterButtons();
                this.renderTasks();
            }
            
            setStatusFilter(status) {
                this.filterStatus = status;
                this.updateFilterButtons();
                this.renderTasks();
            }
            
            updateFilterButtons() {
                // Update priority filter buttons
                document.querySelectorAll('.filter-priority').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-700');
                    btn.classList.add('border-gray-200', 'text-gray-600');
                });
                
                if (this.filterPriority) {
                    const btn = document.querySelector(`[data-priority="${this.filterPriority}"]`);
                    btn.classList.add('border-blue-500', 'bg-blue-50', 'text-blue-700');
                    btn.classList.remove('border-gray-200', 'text-gray-600');
                }
                
                // Update status filter buttons
                document.querySelectorAll('.filter-status').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'bg-blue-50', 'text-blue-700');
                    btn.classList.add('border-gray-200', 'text-gray-600');
                });
                
                const statusBtn = document.querySelector(`[data-status="${this.filterStatus}"]`);
                statusBtn.classList.add('border-blue-500', 'bg-blue-50', 'text-blue-700');
                statusBtn.classList.remove('border-gray-200', 'text-gray-600');
                
                // Show/hide clear button
                const clearBtn = document.getElementById('clearFiltersBtn');
                if (this.filterPriority || this.filterStatus !== 'all') {
                    clearBtn.classList.remove('hidden');
                } else {
                    clearBtn.classList.add('hidden');
                }
            }
            
            clearFilters() {
                this.filterPriority = null;
                this.filterStatus = 'all';
                this.updateFilterButtons();
                this.renderTasks();
            }
            
            renderTasks() {
                const taskList = document.getElementById('taskList');
                const emptyState = document.getElementById('emptyState');
                
                const currentTasks = this.tasks[this.activeTab] || [];
                const filteredTasks = this.filterTasks(currentTasks);
                
                if (filteredTasks.length === 0) {
                    taskList.innerHTML = '';
                    emptyState.classList.remove('hidden');
                    return;
                }
                
                emptyState.classList.add('hidden');
                
                taskList.innerHTML = filteredTasks.map((task, index) => `
                    <li class="task-item flex items-center px-4 py-3 ${task.completed ? 'task-item-completed' : ''}" data-task-id="${task.id}">
                        <span class="mr-2 text-sm">${this.getPriorityIcon(task.priority)}</span>
                        
                        <button class="flex-shrink-0 w-6 h-6 rounded-full border-2 mr-3 transition-colors ${task.completed ? 'border-blue-400 bg-blue-200' : 'border-gray-300 bg-white'}" onclick="app.toggleTask('${task.id}')">
                            ${task.completed ? '<svg class="w-4 h-4 text-blue-600 mx-auto" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg>' : ''}
                        </button>
                        
                        <div class="flex-1 min-w-0">
                            <span class="text-base font-medium text-gray-800 ${task.completed ? 'line-through' : ''}">${task.text}</span>
                            
                            <div class="flex items-center gap-2 mt-1 text-xs text-gray-500">
                                ${task.dueDate ? `<span class="flex items-center gap-1 ${this.isOverdue(task.dueDate) ? 'text-red-500' : ''}">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                    ${this.formatDueDate(task.dueDate)}
                                </span>` : ''}
                                
                                ${task.tags && task.tags.length > 0 ? `<div class="flex gap-1">
                                    ${task.tags.slice(0, 2).map(tag => `<span class="px-1.5 py-0.5 bg-gray-100 rounded text-xs">${tag}</span>`).join('')}
                                    ${task.tags.length > 2 ? `<span class="text-xs">+${task.tags.length - 2}</span>` : ''}
                                </div>` : ''}
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-1 ml-2">
                            <button class="p-1 text-gray-300 hover:text-red-400 transition-colors" onclick="app.deleteTask('${task.id}')">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </li>
                `).join('');
            }
            
            filterTasks(tasks) {
                return tasks.filter(task => {
                    const matchesSearch = task.text.toLowerCase().includes(this.searchTerm.toLowerCase()) ||
                                        (task.notes && task.notes.toLowerCase().includes(this.searchTerm.toLowerCase())) ||
                                        (task.tags && task.tags.some(tag => tag.toLowerCase().includes(this.searchTerm.toLowerCase())));
                    
                    const matchesPriority = !this.filterPriority || task.priority === this.filterPriority;
                    
                    const matchesStatus = this.filterStatus === 'all' || 
                                        (this.filterStatus === 'completed' && task.completed) ||
                                        (this.filterStatus === 'pending' && !task.completed);
                    
                    return matchesSearch && matchesPriority && matchesStatus;
                }).sort((a, b) => {
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    const aPriority = priorityOrder[a.priority] || 0;
                    const bPriority = priorityOrder[b.priority] || 0;
                    
                    if (aPriority !== bPriority) return bPriority - aPriority;
                    
                    if (a.dueDate && b.dueDate) {
                        return a.dueDate.getTime() - b.dueDate.getTime();
                    }
                    if (a.dueDate) return -1;
                    if (b.dueDate) return 1;
                    
                    return b.createdAt.getTime() - a.createdAt.getTime();
                });
            }
            
            toggleTask(taskId) {
                const task = this.tasks[this.activeTab].find(t => t.id === taskId);
                if (task) {
                    task.completed = !task.completed;
                    task.completedAt = task.completed ? new Date() : null;
                    this.saveTasks();
                    this.renderTasks();
                    this.updateTaskCount();
                }
            }
            
            deleteTask(taskId) {
                this.tasks[this.activeTab] = this.tasks[this.activeTab].filter(t => t.id !== taskId);
                this.saveTasks();
                this.renderTasks();
                this.updateTaskCount();
            }
            
            updateTaskCount() {
                const currentTasks = this.tasks[this.activeTab] || [];
                const count = currentTasks.length;
                document.getElementById('taskCount').textContent = `${count} task${count !== 1 ? 's' : ''}`;
            }
            
            showStats() {
                const currentTasks = this.tasks[this.activeTab] || [];
                const totalTasks = currentTasks.length;
                const completedTasks = currentTasks.filter(t => t.completed).length;
                const pendingTasks = totalTasks - completedTasks;
                const overdueTasks = currentTasks.filter(t => t.dueDate && this.isOverdue(t.dueDate) && !t.completed).length;
                const highPriorityTasks = currentTasks.filter(t => t.priority === 'high' && !t.completed).length;
                const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
                
                document.getElementById('totalTasks').textContent = totalTasks;
                document.getElementById('completedTasks').textContent = completedTasks;
                document.getElementById('pendingTasks').textContent = pendingTasks;
                document.getElementById('overdueTasks').textContent = overdueTasks;
                document.getElementById('completionRate').textContent = `${completionRate}%`;
                document.getElementById('completionBar').style.width = `${completionRate}%`;
                
                const highPriorityAlert = document.getElementById('highPriorityAlert');
                const highPriorityText = document.getElementById('highPriorityText');
                
                if (highPriorityTasks > 0) {
                    highPriorityAlert.classList.remove('hidden');
                    highPriorityText.textContent = `${highPriorityTasks} high priority task${highPriorityTasks !== 1 ? 's' : ''} pending`;
                } else {
                    highPriorityAlert.classList.add('hidden');
                }
                
                document.getElementById('statsModal').classList.remove('hidden');
            }
            
            hideStats() {
                document.getElementById('statsModal').classList.add('hidden');
            }
            
            // Utility methods
            generateId() {
                return Math.random().toString(36).slice(2, 10) + Date.now().toString(36);
            }
            
            getPriorityIcon(priority) {
                switch (priority) {
                    case 'high': return '🔴';
                    case 'medium': return '🟡';
                    case 'low': return '🟢';
                    default: return '⚪';
                }
            }
            
            formatDueDate(date) {
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                
                if (date.toDateString() === today.toDateString()) return 'Today';
                if (date.toDateString() === tomorrow.toDateString()) return 'Tomorrow';
                
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            }
            
            isOverdue(date) {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                return date < today;
            }
            
            loadTasks() {
                try {
                    const stored = localStorage.getItem('done-app-data');
                    if (stored) {
                        const parsed = JSON.parse(stored);
                        // Convert date strings back to Date objects
                        Object.keys(parsed).forEach(tabKey => {
                            parsed[tabKey] = parsed[tabKey].map(task => ({
                                ...task,
                                createdAt: new Date(task.createdAt),
                                dueDate: task.dueDate ? new Date(task.dueDate) : null,
                                completedAt: task.completedAt ? new Date(task.completedAt) : null,
                            }));
                        });
                        return parsed;
                    }
                } catch (error) {
                    console.error('Failed to load tasks:', error);
                }
                return {};
            }
            
            saveTasks() {
                try {
                    localStorage.setItem('done-app-data', JSON.stringify(this.tasks));
                } catch (error) {
                    console.error('Failed to save tasks:', error);
                }
            }
        }
        
        // Initialize the app
        const app = new DoneApp();
        
        // Load demo data function (for testing)
        function loadDemoData() {
            const demoData = {
                work: [
                    {
                        id: 'work-1',
                        text: 'Review quarterly reports',
                        completed: false,
                        priority: 'high',
                        dueDate: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000),
                        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                        notes: 'Focus on Q3 performance metrics',
                        tags: ['reports', 'quarterly']
                    },
                    {
                        id: 'work-2',
                        text: 'Schedule team meeting',
                        completed: true,
                        priority: 'medium',
                        dueDate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
                        completedAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                        notes: 'Discuss project timeline',
                        tags: ['meeting', 'team']
                    }
                ],
                personal: [
                    {
                        id: 'personal-1',
                        text: 'Call mom',
                        completed: false,
                        priority: 'high',
                        dueDate: new Date(Date.now() + 1 * 24 * 60 * 60 * 1000),
                        createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                        notes: 'Check on her health',
                        tags: ['family', 'health']
                    }
                ]
            };
            
            try {
                localStorage.setItem('done-app-data', JSON.stringify(demoData));
                location.reload();
            } catch (error) {
                console.error('Failed to load demo data:', error);
            }
        }
        
        // Make functions available globally for testing
        window.loadDemoData = loadDemoData;
        window.app = app;
    </script>
</body>
</html> 